---
title: What exactly are we testig? A closer look at the train/test split
author: Amanda
date: '2020-11-08'
slug: what-exactly-are-we-testig-a-closer-look-at-the-train-test-split
categories:
  - Machine Learning
draft: false
tags: [ml]
output:
  blogdown::html_page:
#    theme: cerulean
    toc: false
#    toc_float: true
#    toc_depth: 1
#    number_sections: true
#    code_folding: show
#    includes:
#      in_header: header_github.html
---

<link href="{{< relref "post/2020-11-08-what-exactly-are-we-testig-a-closer-look-at-the-train-test-split/index.html" >}}index_files/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="{{< relref "post/2020-11-08-what-exactly-are-we-testig-a-closer-look-at-the-train-test-split/index.html" >}}index_files/anchor-sections/anchor-sections.js"></script>


<p>In the paper <a href="https://arxiv.org/pdf/1907.06902.pdf">Are We Really Making Much Progress? A Worrying Analysis of Recent Neural Recommendation Approaches</a>, authors Dacrema, Cremonesi, and Jannach evaluate various neural networks which were designed for recommendation systems and proposed in prominent machine learning journals. A recommendation system is an information filtering system which uses user history (e.g. purchases, page views, clicks, thumbs up/down, etc) to provide personalized item recommendations to users.</p>
<p>The authors point out a few mistakes or “questionable techniques” used in the research they were attempting to reproduce and evaluate. Figure 1 in the article snippet below points out that, for a particular model they were evaluating, the popularity distribution of items assigned to the test and train data splits did not seem to be the same. <em>Interestingly, this affected the reported results and potentially the claim that the proposed model was a state-of-the-art!</em> See the article for more details.</p>
<p></br></p>
<hr />
<center>
<p><img width="45%" src="images/para1.png"/>
<img width="45%" src="images/para2.png"/></p>
<strong>Figure 1</strong>: Snippet of the 2020 paper, “Are We Really Making Much Progress? A Worrying Analysis of Recent Neural Recommendation Approaches”, by Dacrema, Cremonesi, and Jannach
</center>
<hr />
<p></br></p>
<p>I thought this was a nice example comparing the distribution of two multinomial vectors (i.e. comparing the item popularity of the test set versus the training set). See the <a href="#closing">Closing Thoughts</a> section at the end for a discussion about the multinomial assumption.</p>
<p>Why is this important? Well, because we would like to train our model using data similar that which the model will score in the future. The test set is used to tell us how good (or bad) our model performs on data that it has not seen before.</p>
<p>The authors mentioned that they used the Gini index to evaluate the distribution of the test set. One might also wonder if a hypothesis test could be used to consider the evidence for or against the training and test sets having the same underlying distribution. Let’s look at both approaches.</p>
<div id="the-data" class="section level2">
<h2>The data</h2>
<p>The train and test data mentioned in the article above are available at <a href="https://github.com/lzheng21/SpectralCF/tree/master/data/ml-1m">github.com/lzheng21/SpectralCF</a>.
For convenience I also saved them as R dataframes in the <a href="TODO">data directory</a> of the GitHub repo associated with this analysis. Using R, the data can be loaded as follows.</p>
<pre class="r fold-show"><code>load(&quot;data/train_test.RData&quot;)</code></pre>
<p>Let’s take a peak at the training set. The data is composed of two columns containing user id’s and item id’s. It comes from <a href="https://grouplens.org/datasets/movielens/">MovieLens</a>, which provides data about user movie watching history. The existence of user-item pair in the data means that the user interacted with the item (in this case the user watched the movie). A data scientist can use this information as “implicit feedback”, inferring that the user “liked” the item.</p>
<p><br></p>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#usilzdzmaf .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#usilzdzmaf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#usilzdzmaf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#usilzdzmaf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#usilzdzmaf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#usilzdzmaf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#usilzdzmaf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#usilzdzmaf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#usilzdzmaf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#usilzdzmaf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#usilzdzmaf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#usilzdzmaf .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#usilzdzmaf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#usilzdzmaf .gt_from_md > :first-child {
  margin-top: 0;
}

#usilzdzmaf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#usilzdzmaf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#usilzdzmaf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#usilzdzmaf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#usilzdzmaf .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#usilzdzmaf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#usilzdzmaf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#usilzdzmaf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#usilzdzmaf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#usilzdzmaf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#usilzdzmaf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#usilzdzmaf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#usilzdzmaf .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#usilzdzmaf .gt_left {
  text-align: left;
}

#usilzdzmaf .gt_center {
  text-align: center;
}

#usilzdzmaf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#usilzdzmaf .gt_font_normal {
  font-weight: normal;
}

#usilzdzmaf .gt_font_bold {
  font-weight: bold;
}

#usilzdzmaf .gt_font_italic {
  font-style: italic;
}

#usilzdzmaf .gt_super {
  font-size: 65%;
}

#usilzdzmaf .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="usilzdzmaf" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="2" class="gt_heading gt_title gt_font_normal" style>Sample of Training Data</th>
    </tr>
    <tr>
      <th colspan="2" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">user</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">item</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_center">4025</td>
      <td class="gt_row gt_center">2489</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">4652</td>
      <td class="gt_row gt_center">44</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">4366</td>
      <td class="gt_row gt_center">1200</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">4377</td>
      <td class="gt_row gt_center">141</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">5543</td>
      <td class="gt_row gt_center">1256</td>
    </tr>
  </tbody>
  
  
</table></div>
<p><br></p>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#xjnlqgfvto .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xjnlqgfvto .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xjnlqgfvto .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xjnlqgfvto .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xjnlqgfvto .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xjnlqgfvto .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xjnlqgfvto .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xjnlqgfvto .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xjnlqgfvto .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xjnlqgfvto .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xjnlqgfvto .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xjnlqgfvto .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#xjnlqgfvto .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xjnlqgfvto .gt_from_md > :first-child {
  margin-top: 0;
}

#xjnlqgfvto .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xjnlqgfvto .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xjnlqgfvto .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#xjnlqgfvto .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xjnlqgfvto .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#xjnlqgfvto .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xjnlqgfvto .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xjnlqgfvto .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xjnlqgfvto .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xjnlqgfvto .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xjnlqgfvto .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#xjnlqgfvto .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xjnlqgfvto .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#xjnlqgfvto .gt_left {
  text-align: left;
}

#xjnlqgfvto .gt_center {
  text-align: center;
}

#xjnlqgfvto .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xjnlqgfvto .gt_font_normal {
  font-weight: normal;
}

#xjnlqgfvto .gt_font_bold {
  font-weight: bold;
}

#xjnlqgfvto .gt_font_italic {
  font-style: italic;
}

#xjnlqgfvto .gt_super {
  font-size: 65%;
}

#xjnlqgfvto .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="xjnlqgfvto" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="6" class="gt_heading gt_title gt_font_normal" style>Summary of Training Data</th>
    </tr>
    <tr>
      <th colspan="6" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">Min User ID</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">Max User ID</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">User Count</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">Min Item ID</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">Max Item ID</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">Item Count</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_center">0</td>
      <td class="gt_row gt_center">6013</td>
      <td class="gt_row gt_center">6014</td>
      <td class="gt_row gt_center">0</td>
      <td class="gt_row gt_center">3704</td>
      <td class="gt_row gt_center">3068</td>
    </tr>
  </tbody>
  
  
</table></div>
<p><br></p>
<p>Next, count the number of user interactions per item in each of the train and test datasets. Only the first 6 rows of the result are shown in the table below.</p>
<pre class="r fold-show"><code>item_frequency &lt;- 
  full_join(
    train %&gt;% group_by(item) %&gt;% count() %&gt;% ungroup(),
    test  %&gt;% group_by(item) %&gt;% count() %&gt;% ungroup(),
    by = &quot;item&quot;
  ) %&gt;%
  rename(count_train = n.x, count_test = n.y) %&gt;%
  replace_na(list(count_train = 0, count_test = 0))</code></pre>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#rfmybuwbsa .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rfmybuwbsa .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rfmybuwbsa .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rfmybuwbsa .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rfmybuwbsa .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rfmybuwbsa .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rfmybuwbsa .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rfmybuwbsa .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rfmybuwbsa .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rfmybuwbsa .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rfmybuwbsa .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rfmybuwbsa .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#rfmybuwbsa .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rfmybuwbsa .gt_from_md > :first-child {
  margin-top: 0;
}

#rfmybuwbsa .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rfmybuwbsa .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rfmybuwbsa .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#rfmybuwbsa .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rfmybuwbsa .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#rfmybuwbsa .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rfmybuwbsa .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rfmybuwbsa .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rfmybuwbsa .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rfmybuwbsa .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rfmybuwbsa .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#rfmybuwbsa .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rfmybuwbsa .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#rfmybuwbsa .gt_left {
  text-align: left;
}

#rfmybuwbsa .gt_center {
  text-align: center;
}

#rfmybuwbsa .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rfmybuwbsa .gt_font_normal {
  font-weight: normal;
}

#rfmybuwbsa .gt_font_bold {
  font-weight: bold;
}

#rfmybuwbsa .gt_font_italic {
  font-style: italic;
}

#rfmybuwbsa .gt_super {
  font-size: 65%;
}

#rfmybuwbsa .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="rfmybuwbsa" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">item</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Train Count</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Test Count</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_center">0</td>
      <td class="gt_row gt_right">932</td>
      <td class="gt_row gt_right">5</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">1</td>
      <td class="gt_row gt_right">77</td>
      <td class="gt_row gt_right">0</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">2</td>
      <td class="gt_row gt_right">259</td>
      <td class="gt_row gt_right">1</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">3</td>
      <td class="gt_row gt_right">308</td>
      <td class="gt_row gt_right">2</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">4</td>
      <td class="gt_row gt_right">309</td>
      <td class="gt_row gt_right">85</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">5</td>
      <td class="gt_row gt_right">1186</td>
      <td class="gt_row gt_right">0</td>
    </tr>
  </tbody>
  
  
</table></div>
<p><br></p>
<p>Let’s use this information and to re-create the plot from the paper:</p>
<p><br></p>
<pre class="r"><code>item_frequency %&gt;%
  mutate(train = count_train/max(count_train), test = count_test/max(count_test)) %&gt;%
  arrange(desc(count_train)) %&gt;%
  mutate(train_rank = row_number()) %&gt;%
  select(-count_train, -count_test) %&gt;%
  pivot_longer(-c(item, train_rank), names_to = &quot;data&quot;, values_to = &quot;num_interactions&quot;) %&gt;%
  ggplot(aes(train_rank, num_interactions, group = data, color = data)) +
  geom_line() +
  geom_point() +
  xlab(&quot;Items&quot;) +
  ylab(&quot;Normalized number of interactions&quot;)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-8"></span>
<img src="{{< relref "post/2020-11-08-what-exactly-are-we-testig-a-closer-look-at-the-train-test-split/index.html" >}}index_files/figure-html/unnamed-chunk-8-1.png" alt="Comparison of the provided test and train data" width="672" />
<p class="caption">
Figure 1: Comparison of the provided test and train data
</p>
</div>
<p>I think that looks pretty close to the image in the article! As the authors point out, the items are sorted by their popularity in the training set (in descending order along the horizontal axis). The value of the (normalized) test popularity is also plotted for each item. We can see that the two distributions do not look similar. To be a bit more rigorous we can consider a few statistical procedures.</p>
</div>
<div id="gini-index" class="section level2">
<h2>Gini Index</h2>
<p>The article authors used the Gini index to evaluate the distribution of the provided test set. Let’s try it to see how it works. We’ll use the <a href="https://CRAN.R-project.org/package=ineq"><code>ineq</code></a> R package.</p>
<pre class="r fold-show"><code>#install.packages(&quot;ineq&quot;)
library(ineq)</code></pre>
<p>The Gini index is a measure of inequality ranging from 0 (equality) to 1 (no equality). For example, if there was no popularity bias in the dataset (i.e. all items had the same number of interactions), then the Gini index would be 0. That’s not the case since some movies were watched more than others. Let’s look at the Gini index for the full dataset.</p>
<pre class="r fold-show"><code># Join the previous train &amp; test sets together to get full dataset
data_full &lt;- bind_rows(train,test)

# Gini index for full dataset:
gini_full &lt;- 
  data_full %&gt;% 
  group_by(item) %&gt;% 
  count() %&gt;% 
  ungroup() %&gt;% 
  select(n) %&gt;%
  as.matrix() %&gt;%
  ineq(type=&quot;Gini&quot;)

gini_full</code></pre>
<pre><code>## [1] 0.7497474</code></pre>
<p>The resulting value is approximately 0.75. Assuming the sampled datasets are representative of the original data, we would expect the Gini index of the train and test sets to be close to 0.75. The Gini index for the provided test set is computed below.</p>
<pre class="r fold-show"><code># Gini index for provided test set
gini_provided_test &lt;- 
  item_frequency %&gt;% 
  select(-item, -count_train) %&gt;%
  as.matrix() %&gt;%
  ineq(type=&quot;Gini&quot;)

gini_provided_test</code></pre>
<pre><code>## [1] 0.9044503</code></pre>
<p>The provided test set has a much higher Gini index than the full dataset (0.9 compared to 0.75). The Gini index for the training set (0.76) is much closer.</p>
</div>
<div id="resampling-the-test-data" class="section level2">
<h2>Resampling the test data</h2>
<p>Let’s try sampling our own test set to see how that affects the Gini index. We’ll start with the full dataset, sampling at the same rate as the provided train/test split and stratifying by user.</p>
<pre class="r fold-show"><code># Determine percentage of data that should be sampled for test
(pct_test &lt;- nrow(test)/(nrow(test) + nrow(train)))</code></pre>
<pre><code>## [1] 0.2081349</code></pre>
<pre class="r fold-show"><code># Sample test set (stratify by user)
test_new &lt;- 
  data_full %&gt;% 
  group_by(user) %&gt;%
  slice_sample(prop = pct_test) %&gt;%
  ungroup()

# Put remaining data in train:
train_new &lt;- anti_join(data_full, test_new)

# Recreate our interaction counts for each item:
item_frequency_new &lt;- 
  full_join(
    train_new %&gt;% group_by(item) %&gt;% count() %&gt;% ungroup(),
    test_new  %&gt;% group_by(item) %&gt;% count() %&gt;% ungroup(),
    by = &quot;item&quot;
  ) %&gt;%
  rename(count_train = n.x, count_test = n.y) %&gt;%
  replace_na(list(count_train = 0, count_test = 0))</code></pre>
<p>Let’s visualize the newly sampled train and test data, which we can compare to Figure 2.</p>
<pre class="r fold-hide"><code>item_frequency_new %&gt;%
  mutate(train = count_train/max(count_train), test = count_test/max(count_test)) %&gt;%
  arrange(desc(count_train)) %&gt;%
  mutate(train_rank = row_number()) %&gt;%
  select(-count_train, -count_test) %&gt;%
  pivot_longer(-c(item, train_rank), names_to = &quot;data&quot;, values_to = &quot;num_interactions&quot;) %&gt;%
  ggplot(aes(train_rank, num_interactions, group = data, color = data)) +
  geom_line() +
  geom_point() +
  xlab(&quot;Items&quot;) +
  ylab(&quot;Normalized number of interactions&quot;)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-15"></span>
<img src="{{< relref "post/2020-11-08-what-exactly-are-we-testig-a-closer-look-at-the-train-test-split/index.html" >}}index_files/figure-html/unnamed-chunk-15-1.png" alt="Comparison of our sampled test and train data" width="672" />
<p class="caption">
Figure 2: Comparison of our sampled test and train data
</p>
</div>
<p>The test and train popularity distributions look much closer.</p>
</div>
<div id="gini-index-revisited" class="section level2">
<h2>Gini Index Revisited</h2>
<p>Now we can revisit the Gini index for the re-sampled train/test split.</p>
<pre class="r fold-show"><code># Gini index for our sampled test set:
gini_ours_test &lt;- 
  item_frequency_new %&gt;% 
  select(-item, -count_train) %&gt;%
  as.matrix() %&gt;%
  ineq(type=&quot;Gini&quot;)
gini_ours_test</code></pre>
<pre><code>## [1] 0.7542006</code></pre>
<p>We see that our sampled test set has a Gini index (0.75) that is much closer to that of the full dataset (0.75). Likewise, the Gini index for our sampled training set is 0.75.</p>
<p>But, how much difference in the Gini index can we expect between the two datasets having the same distribution? Is the difference likely due to random sampling or some other reason? Let’s take a look at a couple of hypothesis tests.</p>
</div>
<div id="hypothesis-testing" class="section level2">
<h2>Hypothesis testing</h2>
<div id="chi2-test" class="section level3">
<h3><span class="math inline">\(\chi^2\)</span> Test</h3>
<p>Let’s suppose that our null hypothesis is that the train and test sets have the <em>same</em> underlying distribution (vs the alternative hypothesis that they do not). We can consider the data as a 2 by 3232 contingency table (since there are 3232 items).
One might naively choose to run a <span class="math inline">\(\chi^2\)</span> test to test this hypothesis. Let’s try it on the provided train and test sets:</p>
<pre class="r fold-show"><code>chisq.test(item_frequency$count_train, item_frequency$count_test)</code></pre>
<pre><code>## Warning in chisq.test(item_frequency$count_train, item_frequency$count_test):
## Chi-squared approximation may be incorrect</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  item_frequency$count_train and item_frequency$count_test
## X-squared = 167657, df = 67492, p-value &lt; 2.2e-16</code></pre>
<p>And on our newly sampled test and train sets:</p>
<pre class="r fold-show"><code>chisq.test(item_frequency_new$count_train, item_frequency_new$count_test)</code></pre>
<pre><code>## Warning in chisq.test(item_frequency_new$count_train,
## item_frequency_new$count_test): Chi-squared approximation may be incorrect</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  item_frequency_new$count_train and item_frequency_new$count_test
## X-squared = 306832, df = 54020, p-value &lt; 2.2e-16</code></pre>
<p>Both tests (for the provided data and our sampled data) indicate that there is enough evidence to reject the null hypothesis. <strong>However</strong>, notice the warning that the “Chi_squared approximation may be incorrect.” Recall that one of the rule-of-thumb assumptions for the <span class="math inline">\(\chi^2\)</span> test is that no more than 20% of the cells in the table are less than 5. Let’s check to see if this assumption is satisfied.</p>
<pre class="r fold-show"><code># Check to see percentage of cells that are &lt; 5

value_counts &lt;- 
  # Stack the test/train values in one column
  bind_rows(select(item_frequency, count_train) %&gt;% rename(value = count_train), 
            select(item_frequency, count_test)  %&gt;% rename(value = count_test)) %&gt;%
  # determine count of each value
  group_by(value) %&gt;%
  count() %&gt;%
  ungroup() 

# Determine how many values are less than 5
lt_five &lt;-
  value_counts %&gt;%
  filter(value &lt; 5) %&gt;%
  summarize(num_lt_five = sum(n))

# Determine counts of all values
total &lt;- 
  value_counts %&gt;%
  summarize(total = sum(n))
   
(pct &lt;- lt_five[[1]] / total[[1]]) </code></pre>
<pre><code>## [1] 0.545328</code></pre>
<p>We see here that 54.5% of the data is very small (less than 5), meaning that the assumption in question is <strong>not</strong> satisfied. Thus <span class="math inline">\(\chi^2\)</span> test result cannot be trusted.</p>
<p>Let’s look at an alternative method.</p>
</div>
<div id="hypothesis-testing-of-high-dimensional-and-sparse-discrete-data" class="section level3">
<h3>Hypothesis testing of high dimensional (and sparse) discrete data</h3>
<p>In a <a href="https://amanda.rbind.io/2019/05/24/new-r-package-hddtest/">previous blog post</a> I introduced a new method for testing whether two high dimensional mutlinomial vectors come from the same distribution. Compared to the <span class="math inline">\(\chi^2\)</span> test, this method is more robust in the presence of small values. The R method is available via the <code>hddtest</code> package available in the <a href="https://github.com/AmandaRP/hddtest">AmandaRP/hddtest</a> GitHub repository.</p>
<pre class="r fold-show"><code>#devtools::install_github(&quot;AmandaRP/hddtest&quot;, build = TRUE, build_opts = c(&quot;--no-resave-data&quot;, &quot;--no-manual&quot;))
library(&quot;hddtest&quot;)</code></pre>
<p>To test the null hypothesis that the test and train data come from the same distribution, we might consider using the <code>multinom.test</code> function from this package. However, a simulation experiment shows that the <a href="https://en.wikipedia.org/wiki/Size_(statistics)">size</a> of the test is not well controlled when the data is stratified by user (see the Appendix). In other words, the test is too sensitive.</p>
<p>Alternatively, we can consider the null hypothesis that the test and train vectors are within some neighborhood, <span class="math inline">\(\delta\)</span>. What value of <span class="math inline">\(\delta\)</span> should be used? Figure 4 below shows the p-value curves for various values of <span class="math inline">\(\delta\)</span>, comparing multiple random test/train splits (blue) and also the provided test &amp; train data (red). We won’t actually perform the hypothesis test because we’ve now peaked at our data. However, you can see that the p-value curve for the provided data looks much different than those for the random test/train splits.</p>
<p><img src="{{< relref "post/2020-11-08-what-exactly-are-we-testig-a-closer-look-at-the-train-test-split/index.html" >}}index_files/figure-html/unnamed-chunk-22-1.png" width="768" /></p>
</div>
</div>
<div id="closing" class="section level2">
<h2>Closing Thoughts</h2>
<p>Should we always expect our train and test data to have the same distribution? What if the test/train split were based on time (i.e. we use earlier data to train the model and use the most recent data to test). This might be an interesting experiment for a future blog post or a class exercise.</p>
<p>One might also argue that we should not assume a multinomial distribution for the item counts. If there is correlation between the items (e.g. if the first movie in a series was popular, we might expect the sequel to also do well), then the Dirichlet-multinomial distribution may be a better assumption. In this case, a different hypothesis tests is required.</p>
<p>If you would like to provide feedback on this blog post, you can contact me via Twitter (DM me at <span class="citation">@DrAmandaRP</span> or comment on <a href="TODO">this Twitter post</a>). Thanks for reading!</p>
<details>
<p><summary><strong>Appendix</strong>: Size Study</summary></p>
<p>To understand the size of the hypothesis test (i.e. the <code>multinom.test</code> from the <code>hddtest</code> package) for the application of comparing the test and training datasets, let’s run a simulation sampling mulitple test/train splits.</p>
<pre class="r fold-show"><code>data_full_sim &lt;- data_full
alpha &lt;- 0.05
num_reps &lt;- 10000
stratified &lt;- FALSE
result &lt;- array(NA, dim = num_reps)
for(i in 1:num_reps){
  if(stratified){
    test_sim &lt;- 
      data_full_sim %&gt;% 
      group_by(user) %&gt;%
      slice_sample(prop = pct_test) %&gt;%
      ungroup()
  }else{
    test_sim &lt;- 
      data_full_sim %&gt;% 
      slice_sample(prop = pct_test) 
  }
  
  # Put remaining data in train:
  train_sim &lt;- anti_join(data_full_sim, test_sim)

  # Recreate our interaction counts for each item:
  item_frequency_sim &lt;- 
    full_join(
      train_sim %&gt;% group_by(item) %&gt;% count() %&gt;% ungroup(),
      test_sim  %&gt;% group_by(item) %&gt;% count() %&gt;% ungroup(),
      by = &quot;item&quot;
    ) %&gt;%
    rename(count_train = n.x, count_test = n.y) %&gt;%
    replace_na(list(count_train = 0, count_test = 0))
  
  result[i] &lt;- multinom.test(item_frequency_sim$count_train, item_frequency_sim$count_test)$pvalue 
}
mean(result &lt;= alpha)
# size for stratified data: 0.2351 (using 10K reps). Not controlling size well. 
# size for non-stratified data: 0.0517 (using 10K reps)</code></pre>
<p>Using 10K replications and <span class="math inline">\(\alpha = 0.05\)</span>, the size of the test on the stratified sampled data is 0.2351 (not well controlled). However, the size of the test for the non-stratified sampled data is 0.0517, which is much better. In other words, the test is too sensitive for the stratified sampled dataset.</p>
</details>
</div>
